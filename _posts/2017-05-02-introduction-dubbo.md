---
title:  "Introduction of Dubbo"
header:
  teaser: "dubbo-400x250.jpg"
categories: 
  - Dubbo
tags:
  - Dubbo
author_profile: false
sidebar:
  - title: "Dubbo"
    image: dubbo-400x250.jpg
    image_alt: "dubbo"
    text: 
---
---

{% include toc title="Introduction of Dubbo" %}


## 1. Brief Introduction
DUBBO是一个分布式服务框架，致力于提供高性能和透明化的RPC远程服务调用方案，是阿里巴巴SOA服务化治理方案的核心框架，每天为2,000+个服务提供3,000,000,000+次访问量支持，并被广泛应用于阿里巴巴集团的各成员站点。

在深入了解Dubbo之前，首先要对RPC有初步的了解，如果不是很清楚，请先阅读[Introduction of RPC](https://sanjikk.github.io/Blog/rpc/introduction-rpc/)。

## 2. 远程调用方案

  * RMI框架

    RMI全称为Remote Method Invoke, 是一种远程调用方案。服务端可以创建许多远程对象，提供这些对象的引用，使得不同的客户端可以访问这些对象，调用其中的方法。RMI提供了服务端和客户端相互交互，传递信息和对象的机制。

![image-center]({{ site.url }}{{ site.baseurl }}/images/rmi-flow.gif){: .align-center}
上图说明了使用RMI，客户端如何获取远程对象。首先，RMI Server调用RMI Registry为远程对象绑定一个名字。然后，客户端可以通过访问RMI Registry中远程对象的名字来访问它们，调用其中的方法。RMI系统会使用一个已经存在的Web Server来加载类的定义。

**优点：**如果客户端JVM中没有对象类的定义，也可以通过RMI下载，所以对象的方法都仅仅定义在服务端单一的JVM中。RMI传输的是真实的类，所以到达另一个JVM中，所有的方法都没有任何改变。
{: .notice--info}

关于如何实现一个RMI过程，可以参考[JAVA RMI远程方法调用简单实例](http://www.cnblogs.com/leslies2/archive/2011/05/20/2051844.html)

  * Hessian

    Hessian是caucho公司开发的一种基于二进制RPC协议。(Remote Procedure Call protocol)的轻量级远程调用框架。
    基本思想跟RMI包使用类似，具体内容可以参考[Hessian——轻量级远程调用方案](http://www.cnblogs.com/lyhero11/p/5277583.html)


## 3. Dubbo Framework
Dubbo诞生前遭遇的问题：
  1. 大规模服务化，RMI或者Hessian配置服务的URL异常复杂，F5硬件负载均衡器的单点压力过大。
  2. 服务依赖关系复杂，应用启动顺序不清，架构关系混乱。
  3. 服务调用量增加，服务容量问题日益激增，监测服务器状态，服务响应时间不便。
![image-center]({{ site.url }}{{ site.baseurl }}/images/dubbo-architecture.jpg){: .align-center}

**节点角色说明：**

  * Provider: 暴露服务的服务提供方。
  * Consumer: 调用远程服务的服务消费方。
  * Registry: 服务注册与发现的注册中心。
  * Monitor: 统计服务的调用次调和调用时间的监控中心。
  * Container: 服务运行容器。

**调用关系说明：**

  0.服务容器负责启动，加载，运行服务提供者。
  1.服务提供者在启动时，向注册中心注册自己提供的服务。
  2.服务消费者在启动时，向注册中心订阅自己所需的服务。
  3.注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。
  4.服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。
  5.服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。

**连通性：**

* 注册中心负责服务地址的注册与查找，相当于目录服务，服务提供者和消费者只在启动时与注册中心交互，注册中心不转发请求，压力较小
* 监控中心负责统计各服务调用次数，调用时间等，统计先在内存汇总后每分钟一次发送到监控中心服务器，并以报表展示
* 服务提供者向注册中心注册其提供的服务，并汇报调用时间到监控中心，此时间不包含网络开销
* 服务消费者向注册中心获取服务提供者地址列表，并根据负载算法直接调用提供者，同时汇报调用时间到监控中心，此时间包含网络开销

* 注册中心，服务提供者，服务消费者三者之间均为长连接，监控中心除外
* 注册中心通过长连接感知服务提供者的存在，服务提供者宕机，注册中心将立即推送事件通知消费者
* 注册中心和监控中心全部宕机，不影响已运行的提供者和消费者，消费者在本地缓存了提供者列表
* 注册中心和监控中心都是可选的，服务消费者可以直连服务提供者


**健状性：**

* 监控中心宕掉不影响使用，只是丢失部分采样数据
* 数据库宕掉后，注册中心仍能通过缓存提供服务列表查询，但不能注册新服务
* 注册中心对等集群，任意一台宕掉后，将自动切换到另一台
* 注册中心全部宕掉后，服务提供者和服务消费者仍能通过本地缓存通讯
* 服务提供者无状态，任意一台宕掉后，不影响使用
* 服务提供者全部宕掉后，服务消费者应用将无法使用，并无限次重连等待服务提供者恢复


**伸缩性：**

* 注册中心为对等集群，可动态增加机器部署实例，所有客户端将自动发现新的注册中心
* 服务提供者无状态，可动态增加机器部署实例，注册中心将推送新的服务提供者信息给消费者


**升级性：**

* 当服务集群规模进一步扩大，带动IT治理结构进一步升级，需要实现动态部署，进行流动计算，现有分布式服务架构不会带来阻力